# マスマジ！～魔法数学冒険記～

RPG風教育ゲームで楽しく算数・数学を学ぶ、小学生・中学生向けの学習アプリです。

## 🎮 プロジェクト概要

**コンセプト**: ゲーム性を最優先し、勉強感を出さずに数学を学べるRPG

**対象**: 家族利用（小学生2人、中学生1人、保護者1人）

**技術スタック**:
- 静的サイト（HTML/CSS/JavaScript）
- Tailwind CSS
- **完全無料運用**（サーバーレス不要）
- PWA対応

---

## ✨ 実装済み機能

### 基本機能
- ✅ プレイヤー作成（名前、学年、キャラクター選択）
- ✅ 複数プレイヤー対応（キャラクター選択画面）
- ✅ ワールドマップ（学年別フィルタリング）
- ✅ クエスト画面（問題表示、回答入力）
- ✅ バトルシステム（モンスターとのHP制バトル）
- ✅ 結果画面（正解判定、経験値獲得、レベルアップ）
- ✅ 経験値・レベルシステム
- ✅ プレイヤーデータ永続化（LocalStorage）

### ゲーム要素
- ✅ **バトルシステム**（モンスターとのHP制バトル）
- ✅ **コンボボーナス**（連続正解でダメージ増加）
- ✅ **問題式非表示**（考える力を育成、ヒント1で表示）
- ✅ **3段階ヒントシステム**（経験値減少ペナルティ）
- ✅ **リトライ機能**（不正解時に答えを見せない）
- ✅ **称号システム**
- ✅ **アイテム収集**
- ✅ **バトル中アイテム使用**（HP回復、ヒント無料、経験値ブースター等）
- ✅ **デイリーストリーク**

### UI/UX
- ✅ **ファンタジーRPG風デザイン**
- ✅ **背景画像システム**（バトル、ワールドマップ、キャラクター選択）
- ✅ **モンスター画像表示**（13種類のモンスター）
- ✅ **レスポンシブデザイン**（スマホ・タブレット・PC対応）
- ✅ **PWA対応**（ホーム画面に追加可能）
- ✅ **保護者ダッシュボード**（3人の進捗統計）
- ✅ **データバックアップ・復元機能**（JSONファイルで簡単バックアップ）
- ✅ **効果音システム**（Web Audio API + 音声ファイル対応）

### 教育的特徴
- ✅ **文部科学省学習指導要領に準拠**
- ✅ **主要学習塾カリキュラム参考**（公文、学研、栄光）
- ✅ **学年別ワールド自動表示**
- ✅ **10種類の固定問題**（ファンタジー風ストーリー付き）

---

## 🗺️ 実装済みワールド

### 小学2年生〜4年生
- 🌲 **掛け算の森** - 九九（2桁×1桁）

### 小学3年生〜5年生
- ⛰️ **割り算の洞窟** - 割り算（2桁÷1桁）

### 小学4年生〜6年生
- 🗼 **分数の塔** - 分数の計算
- 🌊 **小数の海** - 小数の計算

### 小学5年生〜中学1年生
- 🏛️ **面積の広場** - 面積計算（長方形、三角形）

> 追加ワールドは `js/worlds.js` で簡単に実装できます

---

## 📁 ファイル構造

```
mathmagic/
├── index.html                    # トップ画面
├── character-select.html         # キャラクター選択画面
├── player-create.html            # プレイヤー作成画面
├── world-map.html                # ワールドマップ
├── quest.html                    # クエスト画面（バトル）
├── result.html                   # 結果画面
├── parent-dashboard.html         # 保護者ダッシュボード
├── manifest.json                 # PWA manifest
├── service-worker.js             # Service Worker
│
├── css/
│   └── style.css                 # カスタムCSS
│
├── js/
│   ├── main.js                   # 共通関数
│   ├── player.js                 # プレイヤー管理
│   ├── world-map.js              # ワールドマップ処理
│   ├── quest.js                  # クエスト処理（固定問題）
│   ├── result.js                 # 結果処理
│   ├── worlds.js                 # ワールドデータベース
│   ├── monster-database.js       # モンスターデータベース
│   ├── battle-system.js          # バトルシステム
│   ├── battle-items.js           # バトルアイテム使用
│   ├── figure-drawer.js          # 図形描画
│   ├── hint-system.js            # ヒントシステム
│   ├── achievement-system.js     # 称号システム
│   ├── inventory-system.js       # アイテムシステム
│   ├── streak-system.js          # デイリーストリーク
│   ├── sound-system.js           # サウンドシステム
│   ├── backup-system.js          # バックアップ・復元
│   └── parent-stats.js           # 保護者ダッシュボード
│
└── assets/
    ├── images/
    │   ├── backgrounds/          # 背景画像
    │   └── monsters/             # モンスター画像
    └── sounds/                   # 効果音・BGM（オプション）
```

---

## 🚀 セットアップ方法

### GitHub Pagesへのデプロイ（推奨）

1. **GitHubにリポジトリを作成**
   ```bash
   cd mathmagic
   git remote add origin https://github.com/ユーザー名/mathmagic.git
   git branch -M main
   git push -u origin main
   ```

2. **GitHub Pagesを有効化**
   - リポジトリの「Settings」→「Pages」
   - Source: 「Deploy from a branch」
   - Branch: 「main」→「/ (root)」
   - 「Save」をクリック

3. **アクセス**
   - `https://ユーザー名.github.io/mathmagic/` で公開

### ローカル開発

1. **ファイルをダウンロード**
   ```bash
   git clone https://github.com/ユーザー名/mathmagic.git
   cd mathmagic
   ```

2. **ローカルサーバーで起動**
   ```bash
   # Python 3の場合
   python -m http.server 8000

   # Node.jsの場合
   npx http-server -p 8000
   ```

3. **ブラウザでアクセス**
   - `http://localhost:8000`

---

## 💰 コスト

### 完全無料！
- **ホスティング**: GitHub Pages（無料）
- **問題生成**: 固定問題（10問）
- **API依存**: なし
- **サーバー**: 不要

**合計**: **0円/月** 🎉

---

## 🎯 今後の拡張

### 1. ワールド拡充（最優先）
- [ ] 文科省カリキュラム調査に基づくワールド設計
- [ ] 各ワールド100問の問題データベース作成
- [ ] 計算・文章題・逆算など多様な問題タイプ

### 2. ゲーム要素強化
- [x] ~~アイテム使用機能~~ ✅ 実装済み
- [ ] キャラクター育成強化
- [ ] アバターカスタマイズ
- [ ] ボス戦

### 3. UI/UX改善
- [x] ~~効果音・BGM~~ ✅ 実装済み（Web Audio API + 音声ファイル対応）
- [ ] アニメーション強化
- [ ] キャラクターイラスト

### 4. 分析機能
- [ ] 苦手分野分析
- [ ] 学習履歴グラフ
- [ ] 推奨ワールド提案

### 5. ソーシャル機能
- [ ] 家族内ランキング
- [ ] 成果バッジシステム
- [ ] 達成シェア機能

### 6. データ管理
- [x] ~~データバックアップ・復元機能~~ ✅ 実装済み

---

## 📚 主な技術仕様

### 問題システム
- **固定問題**: 10種類のファンタジー風問題
- **フォーマット**: story, question, answer, hints
- **拡張性**: `js/quest.js` で簡単に追加可能

### バトルシステム
- **プレイヤーHP**: 100（不正解で-15）
- **モンスターHP**: 100（正解で-10）
- **コンボ**: 3連続で1.5倍、5連続で2倍ダメージ
- **HP継続**: 問題間でHPを保持

### ヒントシステム
- **段階**: 3段階（式 → ヒント2 → ヒント3）
- **ペナルティ**: 100% → 80% → 60% → 40%
- **確認**: ヒント表示前に確認ダイアログ

### モンスターシステム
- **13種類**: スライム、こうもり、ゴブリン、スケルトン、オーク、ドラゴン等
- **画像**: PNG形式（フォールバック絵文字あり）
- **難易度**: 1〜8段階

### PWA機能
- **オフライン**: Service Workerでキャッシュ
- **インストール**: ホーム画面に追加可能
- **体験**: ネイティブアプリのような操作感

---

## 🎓 教育的配慮

### 文部科学省学習指導要領準拠
- 小学1年〜中学3年の算数・数学カリキュラム
- 各学年の到達目標に合わせたワールド設計

### 主要学習塾カリキュラム参考
- 公文式、学研、栄光ゼミナールの教材分析
- 実績ある学習順序を採用

### ゲーミフィケーション
- 勉強感を排除したRPG風デザイン
- 達成感を重視した経験値・レベルシステム
- ストーリーで問題を魅力的に演出

### 考える力の育成
- **問題式を非表示**: 自分で式を考える
- **ヒント1で式表示**: 困ったら式を確認可能
- **段階的ヒント**: 徐々に答えに近づく

---

## ⚠️ 注意事項

1. **家族利用専用**
   - 商用利用不可
   - 第三者への公開不可

2. **データ保存**
   - LocalStorageに保存（ブラウザローカル）
   - ブラウザキャッシュクリアでデータ消失注意

3. **問題の追加**
   - `js/quest.js` の `FALLBACK_PROBLEMS` 配列に追加
   - フォーマットに従って記述

---

## 🐛 トラブルシューティング

### 問題が表示されない
- ブラウザのコンソール（F12）でエラー確認
- キャッシュクリア（Ctrl+Shift+R）

### データが消えた
- LocalStorageをブラウザがクリアした可能性
- 定期的にバックアップ推奨

### 背景画像が表示されない
- `assets/images/backgrounds/` に画像があるか確認
- パスが正しいか確認

---

## 📝 ライセンス

このプロジェクトは家族利用のみを目的としています。商用利用は禁止です。

---

## 🙏 クレジット

- **UI Framework**: Tailwind CSS
- **Icons**: Font Awesome
- **Hosting**: GitHub Pages
- **Charts**: Chart.js

---

## 📞 サポート

ご質問やバグ報告は、ブラウザのコンソール（F12）でエラーを確認の上、お問い合わせください。

Happy Learning! 🎓✨

---

**最終更新**: 2024年11月（完全無料運用版）
